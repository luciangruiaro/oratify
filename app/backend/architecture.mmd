%%{init: {'theme': 'dark', 'themeVariables': { 'primaryColor': '#0de7e7', 'primaryTextColor': '#eeeeee', 'primaryBorderColor': '#2c2d2f', 'lineColor': '#0de7e7', 'secondaryColor': '#c73a52', 'tertiaryColor': '#2c2d2f'}}}%%

flowchart TB
    subgraph Entry["Entry Point"]
        Main["main.py\nFastAPI App\nLifespan Events"]
    end

    subgraph API["API Layer - app/api/"]
        AuthRoutes["auth.py"]
        PresentationRoutes["presentations.py"]
        SlideRoutes["slides.py"]
        SessionRoutes["sessions.py"]
        ResponseRoutes["responses.py"]
        AdminRoutes["admin.py"]
        WSEndpoint["websocket.py"]
    end

    subgraph Core["Core Layer - app/core/"]
        Config["config.py\nPydantic Settings"]
        Security["security.py\nJWT + Bcrypt"]
        Database["database.py\nAsyncSession\nConnection Pool"]
    end

    subgraph Models["Models - app/models/"]
        BaseModel["base.py\nTimestampMixin\nUUIDMixin"]
        SpeakerModel["speaker.py"]
        PresentationModel["presentation.py"]
        SlideModel["slide.py\nJSONB content"]
        SessionModel["session.py"]
        ParticipantModel["participant.py"]
        ResponseModel["response.py"]
    end

    subgraph Services["Services - app/services/"]
        AuthService["auth.py"]
        PresentationService["presentation.py"]
        SessionService["session.py"]
        LLMService["llm.py"]
        WSManager["websocket.py"]
    end

    subgraph Migrations["Alembic - alembic/"]
        AlembicEnv["env.py\nAsync Support"]
        Versions["versions/\n001_initial"]
    end

    subgraph External["External"]
        Postgres[(PostgreSQL 15)]
        OpenAI["OpenAI API"]
        Ollama["Ollama"]
    end

    Main --> API
    Main --> Core
    API --> Services
    Services --> Models
    Models --> Database
    Database --> Postgres
    LLMService --> OpenAI
    LLMService --> Ollama
    Migrations --> Models
