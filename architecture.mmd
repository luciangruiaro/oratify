%%{init: {'theme': 'dark', 'themeVariables': { 'primaryColor': '#0de7e7', 'primaryTextColor': '#eeeeee', 'primaryBorderColor': '#2c2d2f', 'lineColor': '#0de7e7', 'secondaryColor': '#c73a52', 'tertiaryColor': '#2c2d2f'}}}%%

flowchart TB
    subgraph Clients["Client Applications"]
        AudienceWeb["Audience View\n(Mobile PWA)\nâœ… Done"]
        PresenterWeb["Presenter View\n(Desktop)\nâœ… Done"]
        ComposerWeb["Composer\n(Desktop)\nâœ… Done"]
        AdminWeb["Admin Dashboard\n(Desktop)\nðŸ”² Not Started"]
    end

    subgraph Frontend["Frontend Layer - React + Vite âœ…"]
        Router["React Router v6\nâœ… All routes configured"]
        Redux["Redux Toolkit\nauthSlice, presentationsSlice,\nslidesSlice\nâœ… Done"]
        WSClient["WebSocket Client\nuseWebSocket hook\nâœ… Done"]
        APIClient["REST API Client\nAxios + interceptors\nâœ… Done"]
    end

    subgraph Backend["Backend Layer - FastAPI + Python âœ…"]
        RestAPI["REST API Endpoints\nauth, presentations, slides,\nsessions, uploads\nâœ… Done"]
        WSServer["WebSocket Manager\nConnection manager +\nEvent broadcasting\nâœ… Done"]
        AuthService["Auth Service\nJWT + bcrypt\nâœ… Done"]
        SessionMgr["Session Manager\nJoin codes, state machine\nâœ… Done"]
        ResponseAPI["Response API\nðŸ”² Not Started"]
        LLMService["LLM Service\nLiteLLM\nðŸ”² Not Started"]
        AdminAPI["Admin API\nðŸ”² Not Started"]
    end

    subgraph Data["Data Layer âœ…"]
        Postgres[(PostgreSQL 15\nAll 6 models\n+ Alembic migrations\nâœ… Done)]
        Uploads["File Storage\n/uploads/images/\nâœ… Done"]
    end

    subgraph External["External Services ðŸ”²"]
        OpenAI["OpenAI API\nGPT-4o-mini\nðŸ”² Not Connected"]
        Ollama["Ollama\nLocal LLM\nðŸ”² Not Connected"]
    end

    AudienceWeb --> Router
    PresenterWeb --> Router
    ComposerWeb --> Router
    AdminWeb -.->|Not implemented| Router

    Router --> Redux
    Redux --> APIClient
    Redux --> WSClient

    APIClient -->|HTTP/REST| RestAPI
    WSClient <-->|WebSocket| WSServer

    RestAPI --> AuthService
    RestAPI --> SessionMgr
    WSServer --> SessionMgr
    ResponseAPI -.->|Planned| LLMService

    RestAPI --> Postgres
    RestAPI --> Uploads
    SessionMgr --> Postgres
    WSServer --> Postgres

    LLMService -.->|Planned| OpenAI
    LLMService -.->|Planned| Ollama

    style AudienceWeb fill:#0de7e7,stroke:#2c2d2f,color:#2c2d2f
    style AdminWeb fill:#2c2d2f,stroke:#666
    style ResponseAPI fill:#2c2d2f,stroke:#666
    style LLMService fill:#2c2d2f,stroke:#666
    style AdminAPI fill:#2c2d2f,stroke:#666
    style OpenAI fill:#2c2d2f,stroke:#666
    style Ollama fill:#2c2d2f,stroke:#666
